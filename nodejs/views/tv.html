<% include header.html %>
<div class="tv">
	<video id="tvvideo" width="320" height="240" autoplay controls onended="cycleVideo()">
	  <source src="/video/1.m4v" type="video/mp4">
	</video>

	<h1>TV Game Phase Changes</h1>
	<ul id="gamePhaseChanges"></ul>

	<% include scripts.html %>
	<script>
		var socket = io.connect();

		socket.emit( 'joinTV', { username: "Josh", gameCode: "1234" } );

		socket.on( 'changeGamePhase', function( data ){
			var html = $("<li><strong>" + data.phase + "</strong> - " + JSON.stringify(data.data) + "</li>");
			$('#gamePhaseChanges').append( html );
		});
		
		socket.on( 'message', function( data ){
			var html = $("<li><strong>MESSAGE</strong> - " + data.message + "</li>");
			$('#gamePhaseChanges').append( html );
		});	

		// tv video (looping and shitz)
		videoCount = 0;
		videoPlayer = document.getElementById("tvvideo");
		tvVideos = ['/video/1.m4v', '/video/2.mp4'];

		function cycleVideo(){
			videoCount++;
	        if (videoCount == 2) videoCount = 0;
	        var nextVideo = tvVideos[videoCount];
	        videoPlayer.src = nextVideo;
	        videoPlayer.play();
		};
	</script>
</div>
<% include footer.html %>